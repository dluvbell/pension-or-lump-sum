<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="dluvbell">
    <title>Retirement Scenario Calculator: Comparison (v15 - Dropdown)</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
</head>
<body>
    <div class="theme-switch-wrapper">
        <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" />
            <div class="slider round"></div>
        </label>
        <span>Dark Mode</span>
    </div>

    <div class="calculator-container">
        <h1>Retirement Scenario Calculator: Comparison</h1>
        <p>Compares the probabilistic FV of a Lump Sum (Scenario 2) against a Pension (Scenario 1).</p>
        
        <div class="input-grid common-inputs">
            <div class="input-group">
                <label for="current_date">Current Date</label>
                <input type="date" id="current_date">
            </div>
            <div class="input-group">
                <label for="birth_year">Birth Year</label>
                <input type="number" id="birth_year" value="1985">
            </div>
            <div class="input-group">
                <label for="inflation_rate">General Inflation Rate (%)</label>
                <input type="number" id="inflation_rate" value="3" step="0.1">
            </div>
        </div>
        
        <hr>

        <h2>Scenario 1: Pension (Cumulative Total)</h2>
        <div class="input-grid">
            <div class="input-group">
                <label for="pension_payout_start_date">Payout Start Date</label>
                <input type="date" id="pension_payout_start_date">
                <span class="age-display" id="age_pension_start">Age: -</span>
            </div>
            <div class="input-group">
                <label for="pension_payout_end_date">Payout End Date</label>
                <input type="date" id="pension_payout_end_date">
                <span class="age-display" id="age_pension_end">Age: -</span>
            </div>
            <div class="input-group">
                <label for="payout_cola">Payout COLA (%)</label>
                <input type="number" id="payout_cola" value="2" step="0.1">
            </div>
        </div>

        <div class="input-group">
            <label for="annual_payout_today">Annual Payout (Today's $, $)</label>
            <input type="number" id="annual_payout_today" value="52000">
        </div>

        <hr>
        
        <h2>Scenario 2: Lump Sum (CV/Asset)</h2>
        <p style="margin-bottom: 5px; text-align: left;">* Enter mean return and volatility to run Monte Carlo simulation.</p>

        <div class="input-grid scenario2-dates">
            <div class="input-group">
                <label for="cv_start_date">Asset Start Date</label>
                <input type="date" id="cv_start_date">
                <span class="age-display" id="age_cv_start">Age: -</span>
            </div>
            <div class="input-group">
                <label for="cv_end_date">Asset End Date</label>
                <input type="date" id="cv_end_date">
                <span class="age-display" id="age_cv_end">Age: -</span>
            </div>
        </div>
        
        <div class="input-grid">
             <div class="input-group">
                <label for="initial_cv_value">Initial Lump Sum (CV, $)</label>
                <input type="number" id="initial_cv_value" value="600000">
            </div>
            <div class="input-group">
                <label for="mean_return">Mean Annual Return (%)</label>
                <input type="number" id="mean_return" value="7.0" step="0.1">
            </div>
             <div class="input-group">
                <label for="volatility">Annual Volatility (Std Dev, %)</label>
                <input type="number" id="volatility" value="15.0" step="0.1">
            </div>
        </div>
        
        <div class="input-group">
            <label for="simulation_count">Simulation Count (N)</label>
            <select id="simulation_count">
                <option value="1000">1,000 (Fast)</option>
                <option value="5000">5,000</option>
                <option value="10000">10,000 (Recommended)</option>
                <option value="50000">50,000 (Very Slow)</option>
                <option value="100000">100,000 (May Freeze)</option>
            </select>
        </div>

        
        <button id="manage-cw-btn">Manage Annual Contributions/Withdrawals</button>

        <button id="calculate-btn" style="margin-top: 20px;">Run Simulation</button>

        <div class="toggles-wrapper">
            <div class="details-toggle-container">
                <span>Detailed View</span>
                <label class="theme-switch" for="details-toggle">
                    <input type="checkbox" id="details-toggle" />
                    <div class="slider round"></div>
                </label>
            </div>
            <div class="details-toggle-container">
                <span>Graph View</span>
                <label class="theme-switch" for="graph-toggle">
                    <input type="checkbox" id="graph-toggle" />
                    <div class="slider round"></div>
                </label>
            </div>
        </div>


        <div id="result-container" class="hidden">
            <h2>Simulation Results</h2>
            <div id="intermediate-result"></div>
            <p id="result-text"></p>
        </div>

        <div id="graph-container">
            <h3>Probabilistic Comparison: Asset FV vs. Pension FV</h3>
            <canvas id="comparison-chart"></canvas>
        </div>

        <div id="details-table-container">
        </div>

        <div class="disclaimer">
            <p><strong>Disclaimer:</strong> The information provided by this calculator is for educational and illustrative purposes only and should not be considered financial advice. The results are based on the inputs you provide and may not reflect your actual retirement outcome. Please consult with a qualified financial professional before making any investment decisions.</p>
        </div>
        </div>

    <footer>
        <p>&copy; 2025 dluvbell. All Rights Reserved.</p>
    </footer>

    <div id="welcome-modal-overlay" class="modal-overlay">
        <div class="modal">
            <h2>Welcome & Notice</h2>
            <p>This calculator determines the average annual growth rate required for a retirement fund based on your inputs.</p>
            <p>The results, including tables and graphs, are for educational purposes only and do not constitute financial advice. Actual outcomes may vary.</p>
            <div class="modal-agreement">
                <input type="checkbox" id="agreement-checkbox">
                <label for="agreement-checkbox">I have read, understand, and agree to the terms of use.</label>
            </div>
            <button id="modal-confirm-btn" disabled>Acknowledge</button>
        </div>
    </div>
    
    <div id="input-modal-overlay" class="modal-overlay hidden">
        <div class="modal input-modal">
            <h2>Manage Annual Cash Flows (Scenario 2)</h2>
            <p>Define periods for additional contributions (Positive) or withdrawals (Negative).</p>
            
            <div id="cw-inputs-container">
                </div>
            
            <div class="modal-buttons">
                <button id="add-contribution-btn" class="modal-action-btn">➕ Add Contribution</button>
                <button id="add-withdrawal-btn" class="modal-action-btn" style="background-color: #dc3545;">➖ Add Withdrawal</button>
                <button id="close-modal-btn" style="margin-top: 15px;">Close & Save</button>
            </div>
        </div>
    </div>

    <script src="calculator.js"></script>
</body>
</html>
